<script>
        window.onload = function() {
            // 1. Get data from memory
            const savedName = localStorage.getItem('patientName');
            const isNewUser = localStorage.getItem('isNewUser'); // Check for the flag

            const heading = document.getElementById('welcomeHeading');
            const navName = document.getElementById('navName');

            if (savedName) {
                // Update the small name in top right corner
                navName.innerText = savedName;

                // 2. DECIDE WHICH GREETING TO SHOW
                if (isNewUser === 'true') {
                    // It is a NEW registration
                    heading.innerText = "Welcome to the Family, " + savedName + "! ðŸŽ‰";
                    
                    // IMPORTANT: Remove the flag so next time they login, it says "Welcome Back"
                    localStorage.removeItem('isNewUser'); 
                } else {
                    // It is a RETURNING login
                    heading.innerText = "Welcome back, " + savedName + "! ðŸ‘‹";
                }
            } else {
                // Fallback for guest
                heading.innerText = "Welcome to TreatInt! ðŸ‘‹";
                navName.innerText = "Guest User";
            }
        }
    </script>
